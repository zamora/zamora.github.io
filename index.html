<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Literate Drag and Drop Using the Racket GUI</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Literate Drag and Drop Using the Racket GUI</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#%28part._.Introduction%29" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#%28part._.Literate_.Programming%29" class="tocviewlink" data-pltdoc="x">Literate Programming</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#%28part._.Requiring_the_.Racket_.G.U.I%29" class="tocviewlink" data-pltdoc="x">Requiring the Racket GUI</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="#%28part._.A_.Class_for_.Draggable_.Objects%29" class="tocviewlink" data-pltdoc="x">A Class for Draggable Objects</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="#%28part._.Draggable_.Flag%29" class="tocviewlink" data-pltdoc="x">Draggable Flag</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="#%28part._.Draggable_.Fish%29" class="tocviewlink" data-pltdoc="x">Draggable Fish</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="#%28part._.Defining_the_.Canvas%29" class="tocviewlink" data-pltdoc="x">Defining the Canvas</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="#%28part._mouse-events%29" class="tocviewlink" data-pltdoc="x">Handling Mouse Events</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="#%28part._.Main_.Program%29" class="tocviewlink" data-pltdoc="x">Main Program</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="#%28part._.Appendix__.Code_.Outline%29" class="tocviewlink" data-pltdoc="x">Appendix:<span class="mywbr"> &nbsp;</span> Code Outline</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Literate_.Drag_and_.Drop_.Using_the_.Racket_.G.U.I%29" class="tocsubseclink" data-pltdoc="x">Literate Drag and Drop Using the Racket GUI</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Introduction%29" class="tocsubseclink" data-pltdoc="x">Introduction</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Literate_.Programming%29" class="tocsubseclink" data-pltdoc="x">Literate Programming</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Requiring_the_.Racket_.G.U.I%29" class="tocsubseclink" data-pltdoc="x">Requiring the Racket GUI</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3crequire-racket%2Fgui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-racket/gui&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.A_.Class_for_.Draggable_.Objects%29" class="tocsubseclink" data-pltdoc="x">A Class for Draggable Objects</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.Position_of_the_.Object%29" class="tocsubseclink" data-pltdoc="x">Position of the Object</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cposition-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;position-methods&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.Drawing_and_.Clicking_on_an_.Object%29" class="tocsubseclink" data-pltdoc="x">Drawing and Clicking on an Object</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cabstract-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;abstract-methods&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">4.3<tt>&nbsp;</tt></span><a href="#%28part._dragging-an-object%29" class="tocsubseclink" data-pltdoc="x">Dragging an Object</a></td></tr><tr><td><span class="tocsublinknumber">4.4<tt>&nbsp;</tt></span><a href="#%28part._.Final_.Class%29" class="tocsubseclink" data-pltdoc="x">Final Class</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdraggable-object~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-object&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Draggable_.Flag%29" class="tocsubseclink" data-pltdoc="x">Draggable Flag</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdraggable-flag~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-flag&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.Flag_draw_.Method%29" class="tocsubseclink" data-pltdoc="x">Flag <span class="RktSym">draw</span> Method</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cflag-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-draw&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._.Flag_contains__.Method%29" class="tocsubseclink" data-pltdoc="x">Flag <span class="RktSym">contains?</span> Method</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cflag-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-contains?&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Draggable_.Fish%29" class="tocsubseclink" data-pltdoc="x">Draggable Fish</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3crequire-pict~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-pict&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdraggable-fish~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-fish&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cfish-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-draw&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cfish-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-contains?&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">7<tt>&nbsp;</tt></span><a href="#%28part._.Defining_the_.Canvas%29" class="tocsubseclink" data-pltdoc="x">Defining the Canvas</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdrag-canvas~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;drag-canvas&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdraw-background~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-background&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdraw-objects~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-objects&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">8<tt>&nbsp;</tt></span><a href="#%28part._mouse-events%29" class="tocsubseclink" data-pltdoc="x">Handling Mouse Events</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3chandle-mouse-events~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;handle-mouse-events&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">8.1<tt>&nbsp;</tt></span><a href="#%28part._.Event_.Handling_.Variables%29" class="tocsubseclink" data-pltdoc="x">Event Handling Variables</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdefine-mouse-event-variables~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-mouse-event-variables&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">8.2<tt>&nbsp;</tt></span><a href="#%28part._.Button_.Down_.Event%29" class="tocsubseclink" data-pltdoc="x">Button Down Event</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cobject-at~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;object-at&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cbutton-down~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-down&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">8.3<tt>&nbsp;</tt></span><a href="#%28part._.Dragging_.Event%29" class="tocsubseclink" data-pltdoc="x">Dragging Event</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdragging~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;dragging&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3con-drag-method~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;on-drag-method&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">8.4<tt>&nbsp;</tt></span><a href="#%28part._.Button_.Up_.Event%29" class="tocsubseclink" data-pltdoc="x">Button Up Event</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cbutton-up~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-up&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">9<tt>&nbsp;</tt></span><a href="#%28part._.Main_.Program%29" class="tocsubseclink" data-pltdoc="x">Main Program</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cdefine-constants~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-constants&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3ccreate-instances~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;create-instances&gt;</a></span></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3cinitialize-gui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;initialize-gui&gt;</a></span></td></tr><tr><td><span class="tocsublinknumber">10<tt>&nbsp;</tt></span><a href="#%28part._.Appendix__.Code_.Outline%29" class="tocsubseclink" data-pltdoc="x">Appendix:<span class="mywbr"> &nbsp;</span> Code Outline</a></td></tr><tr><td><span class="Smaller"><a href="#%28elem._%28chunk._~3c%2A~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;*&gt;</a></span></td></tr></table></div></div><div class="maincolumn"><div class="main"><h2><a name="(part._.Literate_.Drag_and_.Drop_.Using_the_.Racket_.G.U.I)"></a>Literate Drag and Drop Using the Racket GUI</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Justin Zamora &lt;<a href="mailto:justin@zamora.com">justin@zamora.com</a>&gt;</p></span></div><h3>1<tt>&nbsp;</tt><a name="(part._.Introduction)"></a>Introduction</h3><p>[This example was created for the
<a href="https://racket.discourse.group/t/the-2023-racket-summer-event">2023
Racket Summer Event</a>. The source file is available at
<a href="https://github.com/zamora/literate-drag-and-drop">my GitHub</a>.]</p><p>The <a href="https://www.racket-lang.org/">Racket Programming Language</a>
has an excellent cross-platform
<a href="https://docs.racket-lang.org/gui/index.html">GUI</a> that doesn&rsquo;t
get as much attention as it deserves. In this example, I describe one way to
implement a drag-and-drop protocol using the Racket GUI. Although not
required, it will be helpful to have basic familiarity with the Racket GUI
and its classes.</p><p>This example implements a minimal program that draws two objects on a light
blue background: a rectangular flag and a <span class="RktSym"><a href="http://docs.racket-lang.org/pict/More_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._standard-fish%29%29" class="RktValLink" data-pltdoc="x">standard-fish</a></span>. You can use
your mouse to drag the two objects around and place them anywhere on the
canvas. Be careful, though: this example program is not robust. It doesn&rsquo;t do
any bounds checking, so it is possible to drag the objects outside the window
and lose them forever. If this happens, you will need to restart the program.</p><h3>2<tt>&nbsp;</tt><a name="(part._.Literate_.Programming)"></a>Literate Programming</h3><p>This is a
<a href="https://en.wikipedia.org/wiki/Literate_programming">literate
program</a>. That means that the
<a href="https://github.com/zamora/literate-drag-and-drop">source code</a>
produces both the program and its documentation using the same files.
Racket&rsquo;s literate programming language, called <a href="http://docs.racket-lang.org/scribble/lp.html#%28mod-path._scribble%2Flp2%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a>,
separates the code from the documentation and processes each of them
appropriately.</p><p>To run the program, open the <span class="stt">literate-drag-and-drop.scrbl</span>
file in
<a href="https://docs.racket-lang.org/drracket/index.html">DrRacket</a> and
click on &ldquo;Run&rdquo;. You can also run <span class="stt">racket
literate-drag-and-drop.scrbl</span> from the command line. To generate HTML
documentation, either open the <span class="stt">literate-drag-and-drop.scrbl</span>
file in
<a href="https://docs.racket-lang.org/drracket/index.html">DrRacket</a> and
click on &#8220;Scribble HTML&#8221; or run <span class="stt">scribble +m
literate-drag-and-drop.scrbl</span> from the command line.</p><p>In a literate program, chunks of code are interspersed with the text of the
documentation. In <a href="http://docs.racket-lang.org/scribble/lp.html#%28mod-path._scribble%2Flp2%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a>, by convention, the chunks are
given names that start with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">&lt;</span><span class="hspace"></span></span> and end with <span class="RktInBG"><span class="hspace"></span><span class="RktIn">&gt;</span><span class="hspace"></span></span>. Chunk names
can appear within the code to refer to other chunks. When Racket processes
the file, it gathers all the chunks and puts them in the correct order to
produce the final program.</p><p>One advantage of literate programming is that, by having the code and the
documentation in the same file, you can develop them together so that they
reinforce each other. You can describe the thinking and reasoning behind a
program in more depth and in a better format than that allowed by normal
comments.</p><h3>3<tt>&nbsp;</tt><a name="(part._.Requiring_the_.Racket_.G.U.I)"></a>Requiring the Racket GUI</h3><p>We start our program by requiring the <span class="RktSym">racket/gui</span> library. This gives
us access to all the tools and functions of the Racket GUI.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3crequire-racket/gui~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3crequire-racket%2Fgui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-racket/gui&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">racket/gui</span><span class="RktPn">)</span></p></blockquote></div></p><p>Note: In normal programs, we can specify the Racket GUI language by using
<a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="stt"> </span><a href="http://docs.racket-lang.org/gui/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/gui</span></a>, however, since we are
using Racket&rsquo;s literate programming, our language is
<a href="http://docs.racket-lang.org/scribble/lp.html#%28mod-path._scribble%2Flp2%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a>}, and the current version of
<a href="http://docs.racket-lang.org/scribble/lp.html#%28mod-path._scribble%2Flp2%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">scribble/lp2</span></a> doesn&rsquo;t allow us to specify another language for
the code. Some other literate programming packages, like
<a href="https://docs.racket-lang.org/hyper-literate/">Suzanne Soy&rsquo;s
Hyper-literate programming</a> and
<a href="https://docs.racket-lang.org/brush/index.html">David
Christiansen&rsquo;s Brush</a> provide options for specifying other languages.</p><h3>4<tt>&nbsp;</tt><a name="(part._.A_.Class_for_.Draggable_.Objects)"></a>A Class for Draggable Objects</h3><p>The first thing we will do is create an abstract class called
<span class="RktSym">draggable-object%</span> to represent a GUI object that can be dragged
around on a <span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas_.html" class="RktValLink" data-pltdoc="x">canvas%</a></span>. Each different kind of draggable object will be
a subclass that implements methods specialized for that particular kind of
object.</p><p>A draggable object has to have the following things:</p><ul><li><p>The position of the object on a canvas</p></li><li><p>A method to draw a visual representation of the object</p></li><li><p>A method to determine whether the user clicked on the object</p></li><li><p>A method to change the position of the object as it is dragged</p></li></ul><h4>4.1<tt>&nbsp;</tt><a name="(part._.Position_of_the_.Object)"></a>Position of the Object</h4><p>The position of the object is represented using two fields for the <span style="font-style: italic">x</span>
and <span style="font-style: italic">y</span> coordinates of the object. We also define getter and setter
methods for the fields.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cposition-methods~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cposition-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;position-methods&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Fpublic%29%29" class="RktStxLink" data-pltdoc="x">define/public</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">get-x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Fpublic%29%29" class="RktStxLink" data-pltdoc="x">define/public</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set-x</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Fpublic%29%29" class="RktStxLink" data-pltdoc="x">define/public</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">get-y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Fpublic%29%29" class="RktStxLink" data-pltdoc="x">define/public</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">set-y</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>4.2<tt>&nbsp;</tt><a name="(part._.Drawing_and_.Clicking_on_an_.Object)"></a>Drawing and Clicking on an Object</h4><p>Our class needs a <span class="RktSym">draw</span> method to do the actual drawing of the
object. Because every kind of object will need to be drawn differently, we
cannot provide an implementation in the <span class="RktSym">draggable-object%</span> class.
Instead, we use the <span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._abstract%29%29" class="RktStxLink" data-pltdoc="x">abstract</a></span> clause to declare a <span class="RktSym">draw</span>
method without an implementation. The code to draw the object will need to be
provided by each subclass of <span class="RktSym">draggable-object%</span>.</p><p>To determine whether the user clicked on the object, we also need a method,
which we&rsquo;ll call <span class="RktSym">contains?</span>, that returns <span class="RktVal">#t</span> if the
<span style="font-style: italic">x</span> and <span style="font-style: italic">y</span> coordinates of a mouse click are within the bounds
of the object. Since we don&rsquo;t know how the object is drawn, we also have no
way to tell whether the user has clicked within the bounds of the object. So
<span class="RktSym">contains?</span> must also be declared as <span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._abstract%29%29" class="RktStxLink" data-pltdoc="x">abstract</a></span>.</p><p>The code for our abstract methods is very simple:</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cabstract-methods~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cabstract-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;abstract-methods&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._abstract%29%29" class="RktStxLink" data-pltdoc="x">abstract</a></span><span class="hspace">&nbsp;</span><span class="RktSym">contains?</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._abstract%29%29" class="RktStxLink" data-pltdoc="x">abstract</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draw</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>4.3<tt>&nbsp;</tt><a name="(part._dragging-an-object)"></a>Dragging an Object</h4><p>We need to define a method, which we&rsquo;ll call <span class="RktSym">on-drag</span>, that is called
when the user drags the mouse. This method is responsible for moving the
object to follow the mouse as it is dragged.</p><p>It turns out that the <span class="RktSym">on-drag</span> method needs to share information and
cooperate with other mouse-handling methods, so the details of its
implementation are given along with the other mouse actions in the section
&ldquo;<a href="#%28part._mouse-events%29" data-pltdoc="x">Handling Mouse Events</a>&rdquo;.</p><h4>4.4<tt>&nbsp;</tt><a name="(part._.Final_.Class)"></a>Final Class</h4><p>Having worked out all the requirements of a draggable object, here is the
final definition of the <span class="RktSym">draggable-object%</span> class.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdraggable-object~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdraggable-object~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-object&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-object%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._class%29%29" class="RktStxLink" data-pltdoc="x">class</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28def._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._object~25%29%29" class="RktValLink" data-pltdoc="x">object%</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._super-new%29%29" class="RktStxLink" data-pltdoc="x">super-new</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cabstract-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;abstract-methods&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cposition-methods~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;position-methods&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3con-drag-method~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;on-drag-method&gt;</a><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h3>5<tt>&nbsp;</tt><a name="(part._.Draggable_.Flag)"></a>Draggable Flag</h3><p>Now that we have defined our <span class="RktSym">draggable-object%</span> class, we can create
a subclass to represent a draggable flag.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdraggable-flag~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdraggable-flag~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-flag&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-flag%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._class%29%29" class="RktStxLink" data-pltdoc="x">class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-object%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._super-new%29%29" class="RktStxLink" data-pltdoc="x">super-new</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._inherit-field%29%29" class="RktStxLink" data-pltdoc="x">inherit-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._inherit-field%29%29" class="RktStxLink" data-pltdoc="x">inherit-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cflag-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-draw&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cflag-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-contains?&gt;</a><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>In this subclass, we inherit the <span class="RktSym">x</span> and <span class="RktSym">y</span> position fields
from <span class="RktSym">draggable-object%</span>. We then add <span class="RktSym">width</span> and
<span class="RktSym">height</span> fields to represent the dimensions of the flag.</p><h4>5.1<tt>&nbsp;</tt><a name="(part._.Flag_draw_.Method)"></a>Flag <span class="RktSym">draw</span> Method</h4><p>We now define the <span class="RktSym">draw</span> method for our flag, which will consist of a
rectangular background with a circle in the center. Since <span class="RktSym">draw</span> in
the parent class is an abstract method, we use <span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span> to
override the abstract method and provide our own implementation.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cflag-draw~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cflag-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-draw&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Draw the rectangle</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">set-pen</span><span class="hspace">&nbsp;</span><span class="RktVal">"black"</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">transparent</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">set-brush</span><span class="hspace">&nbsp;</span><span class="RktVal">"darkmagenta"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">solid</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draw-rectangle</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">Draw the circle</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">set-brush</span><span class="hspace">&nbsp;</span><span class="RktVal">"yellow"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">solid</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">diameter</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktVal">0.6</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draw-ellipse</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktSym">diameter</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktSym">diameter</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">diameter</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">diameter</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>We draw the flag in two stages: the rectangle and then the circle. We set the
pen to be transparent so that the flag doesn&rsquo;t have a border. Next, we set
the color of the rectangle to be dark magenta. I chose dark magenta for
<a href="https://venngage.com/blog/accessible-colors">accessibility</a>,
because it provides good contrast against the light blue background.</p><p>For the circle, we set color to yellow (again, to improve contrast and
accessibility). Then we draw the circle itself, using the
<span class="RktSym">draw-ellipse</span> method. We use a little bit of math to position the
circle at the center of the rectangle.</p><h4>5.2<tt>&nbsp;</tt><a name="(part._.Flag_contains__.Method)"></a>Flag <span class="RktSym">contains?</span> Method</h4><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>For some objects, only certain "hot spots" should be clickable
and not the entire object. In that case, <span class="RktSym">contains?</span> should return
<span class="RktVal">#t</span> if the point is in any of the hot spots.</p></blockquote></blockquote></blockquote><p>The <span class="RktSym">contains?</span> method takes an (<span style="font-style: italic">x</span>, <span style="font-style: italic">y</span>) coordinate
and returns <span class="RktVal">#t</span> if the coordinate lies inside the flag. This is used
to determine whether the user clicked on the object.</p><p>For complex objects, the check could be quite involved, but since this is a
simple rectangle, the check is very straightforward.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cflag-contains~3f~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cflag-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;flag-contains?&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">contains?</span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h3>6<tt>&nbsp;</tt><a name="(part._.Draggable_.Fish)"></a>Draggable Fish</h3><p>We want our second object to be a <span class="RktSym"><a href="http://docs.racket-lang.org/pict/More_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._standard-fish%29%29" class="RktValLink" data-pltdoc="x">standard-fish</a></span>. Since
<span class="RktSym"><a href="http://docs.racket-lang.org/pict/More_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._standard-fish%29%29" class="RktValLink" data-pltdoc="x">standard-fish</a></span> is part of the <a href="http://docs.racket-lang.org/pict/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">pict</span></a> library of
functional pictures, we need to use <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> to access its
definition.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3crequire-pict~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3crequire-pict~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-pict&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Pict_Datatype.html#%28def._%28%28lib._pict%2Fmain..rkt%29._pict%29%29" class="RktValLink" data-pltdoc="x">pict</a></span><span class="RktPn">)</span></p></blockquote></div></p><p>The class for a draggable fish is very much like <span class="RktSym">draggable-flag</span>: we
inherit the position fields, add width and height fields, and override the
abstract <span class="RktSym">draw</span> method.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdraggable-fish~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdraggable-fish~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-fish&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-fish%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._class%29%29" class="RktStxLink" data-pltdoc="x">class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-object%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._super-new%29%29" class="RktStxLink" data-pltdoc="x">super-new</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._inherit-field%29%29" class="RktStxLink" data-pltdoc="x">inherit-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._inherit-field%29%29" class="RktStxLink" data-pltdoc="x">inherit-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._init-field%29%29" class="RktStxLink" data-pltdoc="x">init-field</a></span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cfish-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-draw&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cfish-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-contains?&gt;</a><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The implementation of the <span class="RktSym">draw</span> method is also very simple; we just
use the <span class="RktSym"><a href="http://docs.racket-lang.org/pict/Rendering.html#%28def._%28%28lib._pict%2Fmain..rkt%29._draw-pict%29%29" class="RktValLink" data-pltdoc="x">draw-pict</a></span> function to draw the fish.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cfish-draw~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cfish-draw~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-draw&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Rendering.html#%28def._%28%28lib._pict%2Fmain..rkt%29._draw-pict%29%29" class="RktValLink" data-pltdoc="x">draw-pict</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/More_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._standard-fish%29%29" class="RktValLink" data-pltdoc="x">standard-fish</a></span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktPn">#:color</span><span class="hspace">&nbsp;</span><span class="RktVal">"salmon"</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The fish is close enough to rectangular that we can use its bounding box to
check whether the user clicked on it.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cfish-contains~3f~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cfish-contains~3f~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;fish-contains?&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">contains?</span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">width</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktSym">height</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h3>7<tt>&nbsp;</tt><a name="(part._.Defining_the_.Canvas)"></a>Defining the Canvas</h3><p>A <span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas_.html" class="RktValLink" data-pltdoc="x">canvas%</a></span> is a GUI object that lets you draw inside of it. It can
also receive and handle events from the keyboard, mouse, and other GUI
objects.</p><p>We create a subclass of <span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas_.html" class="RktValLink" data-pltdoc="x">canvas%</a></span> specialized for handling and
displaying our draggable objects.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdrag-canvas~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdrag-canvas~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;drag-canvas&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drag-canvas%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._class%29%29" class="RktStxLink" data-pltdoc="x">class</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas_.html" class="RktValLink" data-pltdoc="x">canvas%</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._inherit%29%29" class="RktStxLink" data-pltdoc="x">inherit</a></span><span class="hspace">&nbsp;</span><span class="RktSym">refresh</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cdraw-background~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-background&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3cdraw-objects~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-objects&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28elem._%28chunk._~3chandle-mouse-events~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;handle-mouse-events&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._super-new%29%29" class="RktStxLink" data-pltdoc="x">super-new</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">paint-callback</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/lambda.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">canvas</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-background</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-objects</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Our subclass inherits the methods we will use (in this case, it is only the
<span class="RktSym"><a href="http://docs.racket-lang.org/gui/window___.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._window~3c~25~3e%29._refresh%29%29" class="RktValLink" data-pltdoc="x">refresh</a></span> method) and defines methods to draw the
background, draw the objects, and handle the mouse events.</p><p>After defining the methods, we initialize the parent class using
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._super-new%29%29" class="RktStxLink" data-pltdoc="x">super-new</a></span> and define the paint callback. <span class="RktSym">paint-callback</span> is
a function that is called whenever the canvas needs to redraw its contents.
In our case, the callback calls procedures to draw the background and then
draw the two objects.</p><p>Drawing the background is very simple.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdraw-background~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdraw-background~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-background&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-background</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">set-background</span><span class="hspace">&nbsp;</span><span class="RktVal">"lightblue"</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="hspace">&nbsp;</span><span class="RktSym">clear</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Drawing the objects is more involved. For this example program, there are
only two objects, so I just draw them one after the other.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdraw-objects~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdraw-objects~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draw-objects&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">draw-objects</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-fish</span><span class="hspace">&nbsp;</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-flag</span><span class="hspace">&nbsp;</span><span class="RktSym">draw</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._dc%29%29" class="RktValLink" data-pltdoc="x">dc</a></span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>That works for an example like this one, but it is insufficient for a real
program. First of all, it always draws the fish first and then the flag. This
means that the flag is always on top, even if you are dragging the fish.</p><p>Secondly, this approach doesn&rsquo;t scale. The objects should be stored in a data
structure instead of built into the code. You also want to keep track of the
order of the objects so that they can be drawn correctly.</p><h3>8<tt>&nbsp;</tt><a name="(part._mouse-events)"></a>Handling Mouse Events</h3><p>Whenever the user moves the mouse or performs a mouse operation such as
clicking or dragging, the Racket GUI sends a
<a href="https://docs.racket-lang.org/gui/mouse-event_.html">mouse event</a>
to the canvas. We define the <span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas___.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._canvas~3c~25~3e%29._on-event%29%29" class="RktValLink" data-pltdoc="x">on-event</a></span> method to handle
these events. We also define some variables needed by the event handlers.</p><p>The <span class="RktSym"><a href="http://docs.racket-lang.org/gui/canvas___.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._canvas~3c~25~3e%29._on-event%29%29" class="RktValLink" data-pltdoc="x">on-event</a></span> method checks what kind of event it is and
executes the appropriate code. We respond to three different events:
<span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._button-down~3f%29%29" class="RktValLink" data-pltdoc="x">button-down?</a></span>, <span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._dragging~3f%29%29" class="RktValLink" data-pltdoc="x">dragging?</a></span>, and
<span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._button-up~3f%29%29" class="RktValLink" data-pltdoc="x">button-up?</a></span>. After handling the events, we call the
<span class="RktSym"><a href="http://docs.racket-lang.org/gui/window___.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._window~3c~25~3e%29._refresh%29%29" class="RktValLink" data-pltdoc="x">refresh</a></span> method to redraw the canvas.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3chandle-mouse-events~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3chandle-mouse-events~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;handle-mouse-events&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="#%28elem._%28chunk._~3cdefine-mouse-event-variables~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-mouse-event-variables&gt;</a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Foverride%29%29" class="RktStxLink" data-pltdoc="x">define/override</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">on-event</span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">button-down?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="#%28elem._%28chunk._~3cbutton-down~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-down&gt;</a><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">dragging?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="#%28elem._%28chunk._~3cdragging~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;dragging&gt;</a><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">button-up?</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><a href="#%28elem._%28chunk._~3cbutton-up~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-up&gt;</a><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">refresh</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>8.1<tt>&nbsp;</tt><a name="(part._.Event_.Handling_.Variables)"></a>Event Handling Variables</h4><p>The event handlers need to share some information about the object being
dragged, so we define three variables to keep track of this information. The
<span class="RktSym">active-object</span> variable will always refer to the object being
dragged. Two offset variables are necessary to ensure the smooth movement of
the object while dragging.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdefine-mouse-event-variables~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdefine-mouse-event-variables~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-mouse-event-variables&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">active-object</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null%29%29" class="RktValLink" data-pltdoc="x">null</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>To understand why we need the offsets, note that all objects are positioned
and drawn relative to a starting point. For example, most of the objects in
the <a href="http://docs.racket-lang.org/draw/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket/draw</span></a> and <a href="http://docs.racket-lang.org/pict/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">pict</span></a> libraries are drawn
relative to the top left corner of the bounding rectangle. This creates
problems for us when dragging an object.</p><p>The issue is that a user can click anywhere within the object before dragging
it, and this location could be quite far away from the starting point of the
object. If we use the mouse location as the starting point for drawing the
object, the object would &ldquo;jump&rdquo; to its new location rather than moving
smoothly.</p><p>Instead, we need the object to move as if the user clicked on the actual
starting point. For example, if the starting point is at (100, 200), and the
user clicks at (130, 220), then we need to subtract 30 from the
<span style="font-style: italic">x</span>-coordinate and 20 from the <span style="font-style: italic">y</span>-coordinate so that we can
draw the object in the right spot, without any jumps.</p><p>To implement this, when the user clicks on the mouse button, we compute the
difference between the mouse location and the starting point and store the
result in the offset variables. Then, when we draw the object during the drag
operation, we subtract the offset from the mouse location, so that the object
is drawn in the correct place.</p><h4>8.2<tt>&nbsp;</tt><a name="(part._.Button_.Down_.Event)"></a>Button Down Event</h4><p>A dragging operation begins when the user presses the mouse button. When this
happens, the canvas receives a <span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._button-down~3f%29%29" class="RktValLink" data-pltdoc="x">button-down?</a></span> event. The
first thing we do in response is identify which, if any, of the objects the
user clicked on.</p><p>To do this, we create a helper function, <span class="RktSym">object-at</span>, that takes the
<span style="font-style: italic">x</span> and <span style="font-style: italic">y</span> coordinates of the mouse and returns the object at
those coordinates. If there is no object, it returns <span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null%29%29" class="RktValLink" data-pltdoc="x">null</a></span>.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cobject-at~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cobject-at~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;object-at&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">object-at</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._cond%29%29" class="RktStxLink" data-pltdoc="x">cond</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-flag</span><span class="hspace">&nbsp;</span><span class="RktSym">contains?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">my-flag</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-fish</span><span class="hspace">&nbsp;</span><span class="RktSym">contains?</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">my-fish</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._else%29%29" class="RktStxLink" data-pltdoc="x">else</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null%29%29" class="RktValLink" data-pltdoc="x">null</a></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>As with the <span class="RktSym">draw-objects</span> method, we call the <span class="RktSym">contains?</span>
method for each object in turn, returning it if the object contains the
coordinates. Also, as before, this is not a good method for a real program. A
better choice is to use something like a
<a href="https://en.wikipedia.org/wiki/K-d_tree"><span style="font-style: italic">k</span>-d tree</a> to
store the objects so that they can be searched efficiently using the
coordinates.</p><p>Now we are ready for the implementation of the <span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._button-down~3f%29%29" class="RktValLink" data-pltdoc="x">button-down?</a></span> handler itself. When we receive a <span class="RktSym"><a href="http://docs.racket-lang.org/gui/mouse-event_.html#%28meth._%28%28%28lib._mred%2Fmain..rkt%29._mouse-event~25%29._button-down~3f%29%29" class="RktValLink" data-pltdoc="x">button-down?</a></span>, we get the <span style="font-style: italic">x</span> and <span style="font-style: italic">y</span> coordinates of the mouse.
Then we call <span class="RktSym">object-at</span> to locate the object the user clicked on and
store it in the <span class="RktSym">active-object</span> variable. Finally, we compute the
<span style="font-style: italic">x</span> and <span style="font-style: italic">y</span> offsets.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cbutton-down~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cbutton-down~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-down&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="#%28elem._%28chunk._~3cobject-at~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;object-at&gt;</a></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">get-x</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">get-y</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/let.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._let%29%29" class="RktStxLink" data-pltdoc="x">let</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">clicked-object</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">object-at</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null~3f%29%29" class="RktValLink" data-pltdoc="x">null?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">clicked-object</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">active-object</span><span class="hspace">&nbsp;</span><span class="RktSym">clicked-object</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">clicked-object</span><span class="hspace">&nbsp;</span><span class="RktSym">get-x</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">clicked-object</span><span class="hspace">&nbsp;</span><span class="RktSym">get-y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>8.3<tt>&nbsp;</tt><a name="(part._.Dragging_.Event)"></a>Dragging Event</h4><p>When we receive a dragging event, we make sure that the user is dragging on
an object. Then we get the new location of the mouse and call the object&rsquo;s
<span class="RktSym">on-drag</span> method (see &ldquo;<a href="#%28part._dragging-an-object%29" data-pltdoc="x">Dragging an Object</a>&rdquo;). We pass the
new location and the offsets so that <span class="RktSym">on-drag</span> moves the object
smoothly.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdragging~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdragging~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;dragging&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/when_unless.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._when%29%29" class="RktStxLink" data-pltdoc="x">when</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null~3f%29%29" class="RktValLink" data-pltdoc="x">null?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">active-object</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">active-object</span><span class="hspace">&nbsp;</span><span class="RktSym">on-drag</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">get-x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym">event</span><span class="hspace">&nbsp;</span><span class="RktSym">get-y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">offset-x</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">offset-y</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Here we see one of the strengths of literate programming. Even
though <span class="RktSym">on-drag</span> is a method of <span class="RktSym">draggable-object%</span>, we are
able to describe it here alongside the event handlers, and Racket&rsquo;s literate
programming language will put the code where it belongs.</p></blockquote></blockquote></blockquote><p>Now we can finally implement the <span class="RktSym">on-drag</span> method of the
<span class="RktSym">draggable-object%</span> class. The method subtracts the <span style="font-style: italic">x</span> and
<span style="font-style: italic">y</span> offsets from the new mouse location and uses the result to set the
position of the object.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3con-drag-method~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3con-drag-method~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;on-drag-method&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/createclass.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._define%2Fpublic%29%29" class="RktStxLink" data-pltdoc="x">define/public</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">on-drag</span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktSym">offset-x</span><span class="hspace">&nbsp;</span><span class="RktSym">offset-y</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">x0</span><span class="hspace">&nbsp;</span><span class="RktSym">offset-x</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">y0</span><span class="hspace">&nbsp;</span><span class="RktSym">offset-y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h4>8.4<tt>&nbsp;</tt><a name="(part._.Button_.Up_.Event)"></a>Button Up Event</h4><p>When the user releases the button, the dragging operation is over, so our
<span class="RktSym">button-up</span> handler needs to clean up by resetting the
<span class="RktSym">active-object</span> and the offset variables.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cbutton-up~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cbutton-up~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;button-up&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">active-object</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._null%29%29" class="RktValLink" data-pltdoc="x">null</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-x</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/set_.html#%28form._%28%28quote._~23~25kernel%29._set%21%29%29" class="RktStxLink" data-pltdoc="x">set!</a></span><span class="hspace">&nbsp;</span><span class="RktSym">offset-y</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><h3>9<tt>&nbsp;</tt><a name="(part._.Main_.Program)"></a>Main Program</h3><p>Now that we have the object classes and the canvas defined, all that is left
is to create the main program. Since the classes do all the hard work, this
is straightforward. We start by defining constants for the width and height
of our canvas.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cdefine-constants~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cdefine-constants~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-constants&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">640</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">480</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>Next, we create instances of a flag and a fish. We use a little bit of math to
position them nicely on the canvas.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3ccreate-instances~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3ccreate-instances~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;create-instances&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-flag</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._new%29%29" class="RktStxLink" data-pltdoc="x">new</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-flag%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">1/3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">37</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktVal">75</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">my-fish</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._new%29%29" class="RktStxLink" data-pltdoc="x">new</a></span><span class="hspace">&nbsp;</span><span class="RktSym">draggable-fish%</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="hspace">&nbsp;</span><span class="RktVal">2/3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2F%29%29" class="RktValLink" data-pltdoc="x">/</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._-%29%29" class="RktValLink" data-pltdoc="x"><span class="nobreak">-</span></a></span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktVal">50</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>The final step is to create the frame and canvas for the GUI and display
them.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3cinitialize-gui~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3cinitialize-gui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;initialize-gui&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._frame%29%29" class="RktValLink" data-pltdoc="x">frame</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._new%29%29" class="RktStxLink" data-pltdoc="x">new</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/gui/frame_.html" class="RktValLink" data-pltdoc="x">frame%</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">label</span><span class="hspace">&nbsp;</span><span class="RktVal">"Drag and Drop Example"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">width</span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">height</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">canvas</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/objcreation.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._new%29%29" class="RktStxLink" data-pltdoc="x">new</a></span><span class="hspace">&nbsp;</span><span class="RktSym">drag-canvas%</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">parent</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._frame%29%29" class="RktValLink" data-pltdoc="x">frame</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">min-width</span><span class="hspace">&nbsp;</span><span class="RktSym">WIDTH</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">min-height</span><span class="hspace">&nbsp;</span><span class="RktSym">HEIGHT</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/ivaraccess.html#%28form._%28%28lib._racket%2Fprivate%2Fclass-internal..rkt%29._send%29%29" class="RktStxLink" data-pltdoc="x">send</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/pict/Basic_Pict_Constructors.html#%28def._%28%28lib._pict%2Fmain..rkt%29._frame%29%29" class="RktValLink" data-pltdoc="x">frame</a></span><span class="hspace">&nbsp;</span><span class="RktSym">show</span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></td></tr></table></blockquote></div></p><p>And that&rsquo;s it! We now have a simple, but complete, example of implementing
drag-and-drop within the Racket GUI. We&rsquo;ve also gotten a taste of literate
programming and some of its features. I encourage you to explore more
features of the Racket GUI library and incorporate them into your own
projects. Have fun!</p><h3>10<tt>&nbsp;</tt><a name="(part._.Appendix__.Code_.Outline)"></a>Appendix: Code Outline</h3><p>Here is the outline of the entire program. Racket&rsquo;s literate programming
language uses this outline to gather the chunks that we defined throughout
this document and assemble them into the final, runnable program.</p><p><div class="SIntrapara"><a name="(elem._(chunk._~3c*~3e~3a1))"></a><span style="font-weight: bold"><span style="font-style: italic"><a href="#%28elem._%28chunk._~3c%2A~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;*&gt;</a></span> ::=</span></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="#%28elem._%28chunk._~3crequire-racket%2Fgui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-racket/gui&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cdraggable-object~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-object&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cdraggable-flag~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-flag&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3crequire-pict~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;require-pict&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cdraggable-fish~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;draggable-fish&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cdrag-canvas~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;drag-canvas&gt;</a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><a href="#%28elem._%28chunk._~3cdefine-constants~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;define-constants&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3ccreate-instances~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;create-instances&gt;</a></td></tr><tr><td><a href="#%28elem._%28chunk._~3cinitialize-gui~3e~3a1%29%29" class="plainlink" data-pltdoc="x">&lt;initialize-gui&gt;</a></td></tr></table></blockquote></div></p></div></div><div id="contextindicator">&nbsp;</div></body></html>